<!DOCTYPE html>
<html lang="en">
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>Voice-enabled smart home modules</title>

		<!-- Styles -->
		<link rel="stylesheet" href="css/style.css" type="text/css" />

		<!-- Chart.js -->
		<link
			rel="stylesheet"
			href="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.css"
			integrity="sha512-C7hOmCgGzihKXzyPU/z4nv97W0d9bv4ALuuEbSf6hm93myico9qa0hv4dODThvCsqQUmKmLcJmlpRmCaApr83g=="
			crossorigin="anonymous"
		/>

		<link
			rel="stylesheet"
			href="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.min.css"
			integrity="sha512-/zs32ZEJh+/EO2N1b0PEdoA10JkdC3zJ8L5FTiQu82LR9S/rOQNfQN7U59U9BC12swNeRAz3HSzIL2vpp4fv3w=="
			crossorigin="anonymous"
		/>

		<!-- AwesomeFont -->
		<link
			rel="stylesheet"
			href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
			integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN"
			crossorigin="anonymous"
		/>

		<!-- Bootstrap -->
		<!-- CSS -->
		<link
			rel="stylesheet"
			href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
			integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2"
			crossorigin="anonymous"
		/>

		<!-- Bootstrap Toggle -->
		<link
			href="https://gitcdn.github.io/bootstrap-toggle/2.2.2/css/bootstrap-toggle.min.css"
			rel="stylesheet"
		/>
		<!-- Scripts -->
		<script type="text/javascript">
			let ws;
		</script>
		<script src="js/script.js" type="text/javascript"></script>
	</head>

	<body onload="onBodyLoadAnalytics()">
		<nav class="navbar navbar-expand-md navbar-light bg-light sticky-top">
			<a class="navbar-brand" href="#">IOT</a>
			<button
				class="navbar-toggler"
				type="button"
				data-toggle="collapse"
				data-target="#navbarNavDropdown"
				aria-controls="navbarNavDropdown"
				aria-expanded="false"
				aria-label="Toggle navigation"
			>
				<span class="navbar-toggler-icon"></span>
			</button>
			<div class="collapse navbar-collapse" id="navbarNavDropdown">
				<ul class="navbar-nav">
					<li class="nav-item active">
						<a class="nav-link" href="#"
							>Home<span class="sr-only">(current)</span>
						</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="#">Switches</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="#">Analytics</a>
					</li>
					<li class="nav-item dropdown">
						<a
							class="nav-link dropdown-toggle"
							href="#"
							id="navbarDropdownMenuLink"
							data-toggle="dropdown"
							aria-haspopup="true"
							aria-expanded="false"
						>
							Rooms
						</a>
						<div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
							<a class="dropdown-item" href="#">Bedroom</a>
							<a class="dropdown-item" href="#">Kitchen</a>
							<a class="dropdown-item" href="#">Living room</a>
						</div>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="#">Modules</a>
					</li>
				</ul>
			</div>
		</nav>

		<div id="graph_temperature">
			<div>
				<div class="chart-container">
					<canvas id="canvas"></canvas>
				</div>
				<br />
				<br />
				<button id="randomizeData">Randomize Data</button>
				<button id="addDataset">Add Dataset</button>
				<button id="removeDataset">Remove Dataset</button>
				<button id="addData">Add Data</button>
				<button id="removeData">Remove Data</button>
			</div>
		</div>
		<!-- https://getbootstrap.com/docs/4.1/components/collapse/
		https://jsfiddle.net/KyleMit/S9hhP/ -->

		<!-- Chart.js -->
		<script
			src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.min.js"
			integrity="sha512-d9xgZrVZpmmQlfonhQUvTR7lMPtO7NkZMkA0ABN3PHCbKA5nqylQ/yWlFAyY6hYgdF1Qh6nYiuADWwKB4C2WSw=="
			crossorigin="anonymous"
		></script>
		<script
			src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.bundle.js"
			integrity="sha512-zO8oeHCxetPn1Hd9PdDleg5Tw1bAaP0YmNvPY8CwcRyUk7d7/+nyElmFrB6f7vg4f7Fv4sui1mcep8RIEShczg=="
			crossorigin="anonymous"
		></script>
		<script
			src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.bundle.min.js"
			integrity="sha512-SuxO9djzjML6b9w9/I07IWnLnQhgyYVSpHZx0JV97kGBfTIsUYlWflyuW4ypnvhBrslz1yJ3R+S14fdCWmSmSA=="
			crossorigin="anonymous"
		></script>
		<script
			src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"
			integrity="sha512-hZf9Qhp3rlDJBvAKvmiG+goaaKRZA6LKUO35oK6EsM0/kjPK32Yw7URqrq3Q+Nvbbt8Usss+IekL7CRn83dYmw=="
			crossorigin="anonymous"
		></script>

		<!-- jQuery and JS bundle w/ Popper.js -->
		<script
			src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
			integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
			crossorigin="anonymous"
		></script>
		<script
			src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"
			integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx"
			crossorigin="anonymous"
		></script>
		<!-- Bootstrap Toggle -->
		<script src="https://gitcdn.github.io/bootstrap-toggle/2.2.2/js/bootstrap-toggle.min.js"></script>

		<!-- chartjs graph -->
		<!-- <script src="js/time_graph.js"></script> -->
		<script src="js/moment.js"></script>
		<script src="https://unpkg.com/gauge-chart@latest/dist/bundle.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.bundle.js"></script>

		<script>
			window.chartColors = {
				red: "rgb(255, 99, 132)",
				orange: "rgb(255, 159, 64)",
				yellow: "rgb(255, 205, 86)",
				green: "rgb(75, 192, 192)",
				blue: "rgb(54, 162, 235)",
				purple: "rgb(153, 102, 255)",
				grey: "rgb(201, 203, 207)",
			};

			var MONTHS = [
				"January",
				"February",
				"March",
				"April",
				"May",
				"June",
				"July",
				"August",
				"September",
				"October",
				"November",
				"December",
			];

			var COLORS = [
				"#4dc9f6",
				"#f67019",
				"#f53794",
				"#537bc4",
				"#acc236",
				"#166a8f",
				"#00a950",
				"#58595b",
				"#8549ba",
			];

			// var timeFormat = "MM/DD/YYYY HH:mm";
			var timeFormat = "YYYY-MM-DD HH:mm:ss";

			function newDate(days) {
				return moment().add(days, "d").toDate();
			}

			function newDateString(days) {
				return moment().add(days, "d").format(timeFormat);
			}

			var color = Chart.helpers.color;
			var config = {
				type: "line",
				data: {
					labels: [],
					datasets: [
						{
							label: "Dataset with point data",
							backgroundColor: color(window.chartColors.green)
								.alpha(0.5)
								.rgbString(),
							borderColor: window.chartColors.green,
							fill: false,
							data: [],
						},
					],
				},
				options: {
					title: {
						text: "Chart.js Time Scale",
					},
					scales: {
						xAxes: [
							{
								type: "time",
								time: {
									parser: timeFormat,
									// round: 'day'
									tooltipFormat: "ll HH:mm",
								},
								scaleLabel: {
									display: true,
									labelString: "Date",
								},
							},
						],
						yAxes: [
							{
								scaleLabel: {
									display: true,
									labelString: "value",
								},
							},
						],
					},
				},
			};

			window.onload = function () {
				var ctx = document.getElementById("canvas").getContext("2d");
				window.myLine = new Chart(ctx, config);
			};

			document
				.getElementById("randomizeData")
				.addEventListener("click", function () {
					config.data.datasets.forEach(function (dataset) {
						dataset.data.forEach(function (dataObj, j) {
							if (typeof dataObj === "object") {
								dataObj.y = randomScalingFactor();
							} else {
								dataset.data[j] = randomScalingFactor();
							}
						});
					});

					window.myLine.update();
				});

			var colorNames = Object.keys(window.chartColors);
			document
				.getElementById("addDataset")
				.addEventListener("click", function () {
					var colorName =
						colorNames[config.data.datasets.length % colorNames.length];
					var newColor = window.chartColors[colorName];
					var newDataset = {
						label: "Dataset " + config.data.datasets.length,
						borderColor: newColor,
						backgroundColor: color(newColor).alpha(0.5).rgbString(),
						data: [],
					};

					for (var index = 0; index < config.data.labels.length; ++index) {
						newDataset.data.push(randomScalingFactor());
					}

					config.data.datasets.push(newDataset);
					window.myLine.update();
				});

			document.getElementById("addData").addEventListener("click", function () {
				if (config.data.datasets.length > 0) {
					config.data.labels.push(newDate(config.data.labels.length));

					for (var index = 0; index < config.data.datasets.length; ++index) {
						if (typeof config.data.datasets[index].data[0] === "object") {
							config.data.datasets[index].data.push({
								x: newDate(config.data.datasets[index].data.length),
								y: randomScalingFactor(),
							});
						} else {
							config.data.datasets[index].data.push(randomScalingFactor());
						}
					}

					window.myLine.update();
				}
			});

			document
				.getElementById("removeDataset")
				.addEventListener("click", function () {
					config.data.datasets.splice(0, 1);
					window.myLine.update();
				});

			document
				.getElementById("removeData")
				.addEventListener("click", function () {
					config.data.labels.splice(-1, 1); // remove the label first

					config.data.datasets.forEach(function (dataset) {
						dataset.data.pop();
					});

					window.myLine.update();
				});
		</script>
	</body>
</html>
