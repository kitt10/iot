\chapter{Příznaky pro strojové učení} \label{chap:features}
Při návrhu systému se vycházelo z předpokladu, že uživatel rozhoduje o ručním řízení žaluzií na základě subjektivního odhadu, případně měření, některých fyzikálních veličin. Jedním z cílů této práce je rozhodování uživatele nahradit automatickým rozhodováním, je tedy nutné stanovit množinu veličin, které se budou v pravidelných intervalech měřit a na základě jejich hodnot automaticky generovat vhodné řízení pomocí modelů získaných strojovým učením. Uspořádá-li se tato množina do vektoru, nazve se příznakovým vektorem, jeho prvky pak příznaky. Tato kapitola se zabývá volbou příznaků.

Uživatel může nastavením žaluzie sledovat různé cíle, hlavní 4 byly identifikovány takto:
\begin{enumerate}
    \item\label{itm:dark} Za šera a tmy mají být žaluzie zatažené pro zajištění soukromí uvnitř místnosti při použití umělého osvětlení a zabránění vniknutí světla od projíždějících vozidel v době spánku uživatele v místnosti.
    \item\label{itm:summer} Při slunečných dnech, kdy venkovní vzduch dosahuje teplot blízkých pokojové teplotě nebo je převyšuje, mají žaluzie bránit průniku přímého slunčního záření do místnosti.
    \item\label{itm:winter} Při teplotách nižších, kdy je nutné interiér vytápět, by žaluzie naopak měly umožnit maximální průchod záření oknem, aby se tak místnost vytápěla a nebylo nutné využívat zbytečně vysoké množství energie na běžné vytápění.
    \item\label{itm:wind} V případě silného větru by měly být žaluzie vytažené, aby se zabránilo jejich poškození.
\end{enumerate}
Z \refskl{itm:dark}{bodu} vyplývá, že uživatel sleduje intenzitu osvětlení exteriéru, orientačně je možné ji určit podle času a data, ale silně závisí také na počasí (zejména oblačnosti) a protože jsou na trhu dostupné senzory, které komunikují pomocí standardních sběrnic, je vhodnější ji přímo měřit. Použití umělého osvětlení uvnitř místnosti jimi lze detekovat také. Vnitřní a vnější intenzita osvětlení tedy byly zvoleny jako příznaky.

\refskl{itm:summer,itm:winter}{Body} zmiňují vliv teploty venkovního vzduchu na manuální ovládání uživatelem. Dá se ale předpokládat, že pokud by teplota vzduchu uvnitř místnosti byla podle uživatele příliš nízká, nezastiňoval by okno a nechal místnost vytápět i slunečním zářením i přes vysokou vnější teplotu. Proto byly dalšími příznaky zvoleny teplota vzduchu uvnitř a teplota vzduchu venku. Kromě toho uživatel může sledovat předpověď počasí a na jejím základě vyhodnotit, že je vhodné stínit dříve než teplota v průběhu dne vzroste, protože by už nemusel mít možnost vyhřátý interiér ochladit venkovním vzduchem. Jako příznaky se tedy zvolily předpovězené teploty na hodinu, 2 a 3 dopředu, předpověď nejvyšší denní teploty a odhadovaný stav počasí ve formě číselného kódu. Okamžité teploty byly měřeny pomocí digitálního teploměru (\cref{sec:senzory}), předpovědi a odhad se získávaly z internetu pomocí OpenWeather API (\cref{sec:owm}).

Z \refskl{itm:wind}{bodu} vyplývá vliv rychlosti větru na  žaluzie, proto byla zvolena jako další příznak. Manuální vyhodnocení uživatelem probíhá obvykle subjektivně podle hluku způsobeného kmitáním lamel žaluzií v boční vodicí drážce. Na něj může kromě rychlosti mít vliv i směr větru, kvůli různícímu se obtékání domu proudícím vzduchem. Obě veličiny byly zvoleny jako příznaky, jejich měření bylo vyhodnoceno jako příliš složité a nákladné a odhady jejich hodnot se tedy získávají stejně jako předpovědi teploty (\cref{sec:owm}). Systém žaluzií od firmy Somfy také obsahuje vlastní anemometr, který žaluzie v případě silného větru zadá žaluziím příkaz k vytažení, uživatel ale může být opatrný a žaluzie vytahovat již při nižších rychlostech větru.

Lidé dále mohou mít pravidelné zvyky, které ovlivňují nastavení žaluzií. Z toho důvodu byly jako příznaky zvoleny některé časové údaje: počet uplynulých sekund v rámci dne, počet uplynulých dnů v rámci týdne a pořadí dne v roce. Poslední z nich souvisí také s obvyklým počasím, které může ovlivňovat nastavení žaluzií. V případě nepřítomnosti uživatele v domácnosti nemusí nastavení žaluzií přesně odpovídat obvyklému záměru uživatele, proto je jedním z příznaků také jeho přítomnost v domácnosti. Ta se vyhodnocuje v systému domácí automatizace na základě periodicky přenášené polohy uživatelova telefonu.

Přehled všech 15 příznaků, jejich označení, jednotky a očekávané nejnižší a nejvyšší hodnoty je uveden v \refskl{tab:features}{tabulce}
\input{tab/tab_features.tex}

Po natrénování použitých algoritmů (\cref{chap:regresory}) byla vyhodnocena důležitost jednotlivých příznaků pomocí algoritmu \emph{permutation feature importance} (\cite{breiman:pfi}), při kterém se sleduje vliv permutace hodnot jednotlivých příznaků mezi vzorky v rámci datové sady na přesnost predikce. Důležitost každého příznaku pak odpovídá rozdílu \acrshort{mse} s promíchanými hodnotami tohoto příznaku a s původní datovou sadou (nezamíchanou). Pro každý z příznaků se \acrshort{mse} vyhodnotila 20x pro různé permutace a vypočetl se z nich aritmetický průměr. Důležitost byla vyjádřena jako rozdíl tohoto průměru a původní \acrshort{mse}.